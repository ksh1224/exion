# Migration `20200915022446-exion`

This migration has been generated by 권수현 at 9/15/2020, 11:24:46 AM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
ALTER TABLE `exion`.`Auth` DROP FOREIGN KEY `Auth_ibfk_1`

ALTER TABLE `exion`.`User` ADD COLUMN `createdAt` datetime(3)  DEFAULT CURRENT_TIMESTAMP(3),
ADD COLUMN `updatedAt` datetime(3)  DEFAULT CURRENT_TIMESTAMP(3),
ADD COLUMN `deletedAt` datetime(3)  ,
MODIFY `gender` ENUM('male', 'female')

CREATE TABLE `exion`.`Profile` (
`id` int  NOT NULL  AUTO_INCREMENT,
`socialId` varchar(191)  ,
`authType` ENUM('email', 'facebook', 'google', 'apple')  ,
`userId` varchar(191)  NOT NULL ,
UNIQUE Index `Profile.userId_unique`(`userId`),
PRIMARY KEY (`id`)
) DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci

ALTER TABLE `exion`.`Profile` ADD FOREIGN KEY (`userId`) REFERENCES `exion`.`User`(`id`) ON DELETE CASCADE ON UPDATE CASCADE

DROP TABLE `exion`.`Auth`
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200915013616-exion..20200915022446-exion
--- datamodel.dml
+++ datamodel.dml
@@ -3,34 +3,45 @@
 }
 datasource db {
   provider = "mysql"
-  url = "***"
+  url = "***"
 }
-model Auth {
-  userId  String
-  token   String @unique
-  User    User   @relation(fields: [userId], references: [id])
+enum Gender {
+  male
+  female
+}
-  @@index([userId], name: "userId")
+enum AuthType {
+  email
+  facebook
+  google
+  apple
 }
+model Profile {
+  id                     Int                     @default(autoincrement()) @id
+  socialId               String?
+  authType               AuthType?
+  userId                 String                  @unique
+  User                   User                    @relation(fields: [userId], references: [id])
+}
+
 model User {
-  id           String          @default(cuid()) @id
+  id           String       @default(cuid()) @id
   name         String?
-  phoneNumber  String?       @unique
+  phoneNumber  String?      @unique
   password     String?
   birthday     DateTime?
-  gender       User_gender?
+  gender       Gender?
   height       Int?
   weight       Int?
   isGlasses    Boolean?     @default(dbgenerated())
   isTattoo     Boolean?     @default(dbgenerated())
   isDyeing     Boolean?     @default(dbgenerated())
-  Auth         Auth[]
-}
+  createdAt    DateTime?    @default(now())
+  updatedAt    DateTime?    @default(now()) @updatedAt
+  deletedAt    DateTime?
-enum User_gender {
-  MALE
-  FEMALE
-}
+  profile      Profile?
+}
```


